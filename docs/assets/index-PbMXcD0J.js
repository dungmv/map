(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))a(t);new MutationObserver(t=>{for(const o of t)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&a(s)}).observe(document,{childList:!0,subtree:!0});function l(t){const o={};return t.integrity&&(o.integrity=t.integrity),t.referrerPolicy&&(o.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?o.credentials="include":t.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(t){if(t.ep)return;t.ep=!0;const o=l(t);fetch(t.href,o)}})();function k(e,n){e.src=n}const T=e=>{var n,l,a,t="The Google Maps JavaScript API",o="google",s="importLibrary",h="__ib__",w=document,E=window,u=E[o]||(E[o]={}),i=u.maps||(u.maps={}),f=new Set,g=new URLSearchParams,y=()=>n||(n=new Promise(async(r,d)=>{await(l=w.createElement("script")),g.set("libraries",[...f]+"");for(a in e)g.set(a.replace(/[A-Z]/g,P=>"_"+P[0].toLowerCase()),e[a]);g.set("callback",o+".maps."+h),k(l,"https://maps.googleapis.com/maps/api/js?"+g),i[h]=r,l.onerror=()=>n=d(Error(t+" could not load.")),l.nonce=w.querySelector("script[nonce]")?.nonce||"",w.head.append(l)}));i[s]?console.warn(t+" only loads once. Ignoring:",e):i[s]=(r,...d)=>f.add(r)&&y().then(()=>i[s](r,...d))},S=e=>`The setOptions() function should only be called once. The options passed to the additional call (${JSON.stringify(e)}) will be ignored.`,B=e=>`The google.maps.importLibrary() function is already defined, and @googlemaps/js-api-loader will use the existing function instead of overwriting it. The options passed to setOptions (${JSON.stringify(e)}) will be ignored.`,A=()=>{},C=()=>{};let M=!1;function N(e){if(M){A(S(e));return}$(e),M=!0}async function x(e){if(!window?.google?.maps?.importLibrary)throw new Error("google.maps.importLibrary is not installed.");return await google.maps.importLibrary(e)}function $(e){const n=!!window.google?.maps?.importLibrary;n&&C(B(e)),n||T(e)}N({key:"AIzaSyB41DRUbKWJHPxaFjMAwdrzWzbVKartNGg"});await x("maps");const R=document.getElementById("map");let v=null;const b=document.getElementById("loading"),c=new google.maps.Map(R,{zoom:15,center:{lat:21.036809,lng:105.782771},mapTypeId:google.maps.MapTypeId.ROADMAP}),D=new google.maps.Circle({id:"circle_select_device_id",map:c,strokeColor:"#FF0000",strokeOpacity:.5,strokeWeight:1,fillColor:"#AA0000",fillOpacity:.2,radius:30});D.setMap(c);const p=new google.maps.Marker({title:"Điểm đón khách",icon:"https://s3-ap-southeast-1.amazonaws.com/image-emd/defaults/map-marker-1-32x32.png"}),m=new google.maps.Marker({title:"Điểm trả",icon:"https://s3-ap-southeast-1.amazonaws.com/image-emd/defaults/map-marker-2-32x32.png"}),L=new google.maps.InfoWindow({size:new google.maps.Size(360,180)});function _(e,n,l,a){F(),p.setPosition(n),m.setPosition(l),p.setMap(c),m.setMap(c);const t=google.maps.geometry.encoding.decodePath(e);v=new google.maps.Polyline({path:t,geodesic:!0,strokeColor:"blue",strokeOpacity:1,strokeWeight:4}),v.setMap(c);const o=new google.maps.LatLng(parseFloat((p.getPosition().lat()+m.getPosition().lat())/2),parseFloat((p.getPosition().lng()+m.getPosition().lng())/2));c.setCenter(o);const s=new google.maps.LatLngBounds;s.extend(p.getPosition()),s.extend(m.getPosition()),c.fitBounds(s),L.setContent(a),L.setPosition(o),L.open(c)}function F(){p.setMap(null),p.setMap(null),v&&v.setMap(null),v=null}function I(e){const n=e.split(",");return{lat:parseFloat(n[0]),lng:parseFloat(n[1])}}document.getElementById("btn_search").addEventListener("click",function(){b.style.display="flex";const e=document.getElementById("map-url").value,n=document.getElementById("origin").value.replace(/\s+/g,""),l=document.getElementById("waypoints").value.replace(/\s+/g,""),a=document.getElementById("destination").value.replace(/\s+/g,""),t=document.getElementById("app-code").value;fetch(`${e}/maps/api/directions/json?origin=${n}&destination=${a}&waypoints=${l}`,{method:"GET",headers:{"Content-Type":"application/json","App-Code":t}}).then(o=>{if(!o.ok)throw new Error("Network response was not ok");return o.json()}).then(o=>{const s=I(n),h=I(a),w=o.routes[0].overview_polyline.points,E=o.routes[0].legs[0].distance.text;_(w,s,h,E);const u=document.getElementById("routes");u.innerHTML="",u.style.display="block",o.routes.forEach((i,f)=>{const g=Math.random().toString(36).slice(2,9),y=document.createElement("div");y.className="flex items-center space-x-2";const r=document.createElement("input");r.type="radio",r.id=g,r.name="route",r.value=f,r.className="w-4 h-4",f===0&&(r.checked=!0);const d=document.createElement("label");d.htmlFor=g,d.className="text-sm font-medium cursor-pointer",d.textContent=`${i.summary} | ${i.legs[0].distance.text}, ${i.legs[0].duration.text}`||`Route ${f+1}`,y.appendChild(r),y.appendChild(d),u.appendChild(y),r.addEventListener("change",()=>{if(r.checked){const P=i.overview_polyline&&i.overview_polyline.points,O=i.legs&&i.legs[0]&&i.legs[0].distance&&i.legs[0].distance.text;P&&_(P,s,h,O||"")}})})}).catch(o=>{alert(o)}).finally(()=>{b.style.display="none"})});c.addListener("click",function(e){const n=e.latLng.lat(),l=e.latLng.lng();let a=null,t=null;p.getMap()?m.getMap()||(a=m,t=document.getElementById("destination")):(a=p,t=document.getElementById("origin")),a&&(t.value=`${n},${l}`,a.setPosition(e.latLng),a.setMap(c),a.addListener("click",function(){a.setMap(null),t.value=""}))});
